# Simple File Upload Script

This PHP script provides a simple file upload functionality. It presents a form to the user to select a file to upload. Once the file is selected and the form is submitted, the script processes the uploaded file.

## How it works

The script works as follows:

1. It presents a form to the user with a file input field and a submit button.
2. When the form is submitted, it checks if a file with the same name already exists in the `uploads/` directory.
3. If the file already exists, it displays an error message.
4. If the file does not exist, it attempts to move the uploaded file to the `uploads/` directory.
5. If the file is successfully moved, it displays a success message. If not, it displays an error message.

Here is the main part of the script:

```php
if ($_SERVER['REQUEST_METHOD'] == 'POST') {
    $target_dir = "uploads/";
    $target_file = $target_dir . basename($_FILES["fileToUpload"]["name"]);

    // Check if file already exists
    if (file_exists($target_file)) {
        echo "Sorry, file already exists.";
    } else {
        if (move_uploaded_file($_FILES["fileToUpload"]["tmp_name"], $target_file)) {
            echo "The file ". htmlspecialchars( basename( $_FILES["fileToUpload"]["name"])). " has been uploaded.";
        } else {
            echo "Sorry, there was an error uploading your file.";
        }
    }
}
```

## Differences with the Patched Version

The patched version of this script includes several security improvements:

1. **File Size Check**: The patched version checks the size of the uploaded file and rejects files that are larger than a certain size. This prevents users from uploading excessively large files that could consume server resources.

2. **File Type Check**: The patched version checks the type of the uploaded file and only allows certain file types to be uploaded. This prevents users from uploading potentially dangerous file types, such as PHP scripts that could be executed on the server.

3. **File Name Sanitization**: The patched version sanitizes the name of the uploaded file to remove any potentially dangerous characters. This prevents attacks such as directory traversal attacks, where a malicious user could manipulate the file name to overwrite other files on the server.

These improvements significantly enhance the security of the file upload functionality and help protect the server from potential attacks.